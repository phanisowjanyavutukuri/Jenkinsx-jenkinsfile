#From maven:3.3.9

#COPY ./ /discovery-service/
#RUN chmod -R 777 / intelligent-systems-test/
#WORKDIR  /discovery-service/
#RUN mvn clean  install

#From maven:3.3.9
#RUN mkdir  /discovery-service/
#WORKDIR  /discovery-service/
#COPY --from=0  /discovery-service/  .
#WORKDIR  /discovery-service/discovery-service/
#CMD ["mvn spring-boot", "run"]
#cmd mvn spring-boot:run


FROM maven
RUN apt update
RUN apt install git
COPY . /java/
WORKDIR /java/
RUN git init
RUN git clone http://cloudwms:cloudwms@35.188.95.38/Intelligent_systems/commons.git

WORKDIR /java/commons
RUN mvn clean package install
WORKDIR /java/
RUN mvn clean install

FROM maven
WORKDIR /java/
COPY --from=0  /java/commons/target/ .
COPY --from=0  /java/target/ .
WORKDIR /java/
CMD java -jar discovery-service.jar
